{% load staticfiles %}

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" href="{% static 'open311/css/bootstrap.css' %}" />



       <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>

	<link rel="stylesheet" href="{% static 'open311/css/bootstrap-responsive.css' %}" />
	<link rel="stylesheet" href="{% static 'open311/css/main.css' %}" />
        <!--<link rel="stylesheet" href="css/main.css">-->
        <link rel="stylesheet" href="{% static 'open311/css/leaflet.css' %}" />


        <script src="{% static 'open311/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js' %}"></script>
    </head>


       
<!-- Templates -->

<script id="tmplLogin" type="text/template">
<input id="user" class="span2" type="text" placeholder="Email">
<input id="password" class="span2" type="password" placeholder="Password">
<button id="loginButton" type="button" onclick=login() class="btn">Sign in</button>
<a href="{% url "socialauth_begin" "facebook" %}" class="btn btn-info">Facebook Sign in</a>
<a href="{% url "socialauth_begin" "google" %}" class="btn btn-inverse">Google</a>
</script>

	
<script id="tmplLogout" type="text/template">
<span class="userLogged">Hello <%= user %> </span>
<button id="logoutButton" type="button" onclick=logout() class="btn">Sign out</button>
</script>


<script id="tmplConfirmPos" type="text/template">
<strong>Is position correct ?</strong><br>
<button id="confirm" class="confirm_marker" onclick=markerConfirm(markerLocation)>Confirm</button>&nbsp;
<button class="remove_marker" onclick=markerDelete(marker)>Delete</b>
</script>

<script id="tmplInsertNode" type="text/template">
<p><strong>Insert request details</strong></p>

<form id="requestForm"  >
  <input type="hidden" name="service_code" value="node">
 
	<label for="layerToInsert" >Layer</label>

	<select name="layer" >
	  <% for (var i = 0; i < layers.length; i++) { %>
      <% var layer = layers[i]; %>
	 <option value="<%= layer.slug %>"> <%= layer.name %>
	     <% }
	      %>
	</select>
	</p>
		  
	<label for="nodeToInsertName" >Name</label>
	<input class="input" name="name">

	<label for="nodeToInsertName" >Description</label>
	<textarea class="input" name="description"></textarea>

	<label for="nodeToInsertAddress" >Address <br>(from Open Street Map)</label>
	<div id="loadingAddress" >Loading...</div>
	<textarea id="requestAddress" class="input" name="address"></textarea>	

	<label for="nodeToInsertLat">Lat</label>   
	<input id="requestLat" class="input" name="lat">

	<label for="nodeToInsertLng">Lng</label>   
	<input id="requestLng" class="input" name="long">

	    <label for="imageToInsert">Image</label>   
	 <input type="file" name="image" id="photoimg" >
<br>
	  <input type=submit>
</form>
<div id="request_messages" class="error_messages"></div>
</script>


<script id="tmplLayerList" type="text/template">
<option value="<%= layer.slug %>"> <%= layer.name %>
</option>
</script>

<script id="tmplNodelist" type="text/template">
  Requests found: <strong><%= nodes.length %></strong> 
   <ul> <% for (var i = 0; i < nodes.length; i++) { %>
      <% var node = nodes[i]; %>
      <li>
      <span class="requestID"><%= node.service_request_id %>: </span>
      <a href="#" class="list-link" data-id='<%= node.service_request_id %>'>
      <%= node.name %></a>
      </li>
    <% } %>
  </ul>
</script>

<script id="tmplOpen311Popup" type="text/template">
<strong>Request ID: </strong><%= service_request_id %><br>
<strong>Status: </strong><%= status %><br>
<!--<a href="<%= url %>">View details</a>-->
<button >View details</button>
</script>

<script id="tmplOpen311RequestBox" type="text/template">
<div id="left" class="span6" style="width:420px">
            <div id="request"></div>
            
        </div>
        <div id="right" class="span6" style="width:400px">
	  <div id="votesContainer"></div>
            <div id="ratingContainer"></div>
            <div id="commentsContainer"></div>
        </div>
</script>

<script id="tmplOpen311Request" type="text/template">

<table class="table table-condensed">
  <tr>
<td class="requestField">Request_id</td><td>
<%= requestID %></td>
</tr><tr>
<td class="requestField">Layer</td><td>
<%= request.layer %></td>
</tr><tr>
<td class="requestField">Name</td><td>
<%= request.name %></td>
</tr><tr>
<td class="requestField">Description</td><td>
<%= request.description %></td>
</tr><tr>
<td class="requestField">Status</td><td>
<%= request.status %></td>
</tr><tr>
<td class="requestField">Status detail</td><td>
<%= request.detailed_status %></td>
</tr><tr>
<td class="requestField">Address</td><td>
<%= request.address %></td>
</tr><tr>
<td class="requestField">Requested on</td><td>
<%= request.requested_datetime %></td>
</tr><tr>
<td class="requestField">Updated on</td><td>
<%= request.updated_datetime %></td></tr>
  <tr>
<td class="requestField">Image</td><td>
<img class="thumbnail" src="<%= request.image_urls[0] %>"</td></tr>
</table>
</script>

<script id="tmplOpen311Votes" type="text/template">
<div id="votes">
<div class="intest">Vote</div>           
<p><img src="{% static 'open311/img/likes.jpg' %}" /><%= likes %> </p>
<p><img src="{% static 'open311/img/dislike.jpg' %}" /><%= dislikes %> </p>
<div id="insert_vote" class="insert_vote">
<button id="likeButton">I like it</button>
<button id="unlikeButton">I don't</button>
</div>
<div id="vote_messages" class="thanks_messages"></div>
<div id="vote_error_messages" class="error_messages"></div>
</div>
</script>

<script id="tmplComments" type="text/template">
<div class="intest">Add comments</div>
<div id="comments">
<textarea id="commentText" class="your_comment"></textarea><br>
<button id="post_comments" >Post comment</button>
<div id="comment_messages" class="thanks_messages"></div>
<div id="comment_error_messages" class="error_messages"></div>
<hr>
<p><strong>Comments (<%= comments_count%>) :</strong></p>    
	<div id="comment" >
    <% for (var i = 0; i < comments.length; i++) { %>
      <% var comment = comments[i]; %>
		<div  class="comment_div">
		<span class="comment_user">
		    <%= comment.username %>
		</span>
		<div class="comment_text">
		<%- comment.text %>
		</div>
		<span class="comment_date"><%= comment.added %></span>	
		</div>
		
    <% }
    
    %>
  </div>
</div> 	
</script>

<script id="tmplNodePopupRating" type="text/template">
  <div id="rating">
    <div class="intest">Rate it</div>
<div style="background-color:#C0C0C0">
Rated <strong><%= rating%>/10 </strong> out of <strong><%= votes %></strong> votes </strong></div>
<div id="star"></div>
<div id="rating_messages" class="thanks_messages"></div>
<div id="rating_error_messages" class="error_messages"></div>
</div>
</script>

<!-- End of Templates -->
<body>
  <div class="overlay" id="overlay" style="display:none;"></div>

<div id="RequestDetails" style="display: none;">
<a class="boxclose" id="boxclose"></a>
</div>
<div id="serviceRequestForm" style="display: none;">
</div>

        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">
		      <img src="{% static 'open311/css/images/nodeshot-311-logo.png' %}" />
		    </a>
                    <div class="nav-collapse collapse">
                        
                        <form id="userForm" class="navbar-form pull-right">
			 {% if not user.is_authenticated %}
                         <input id="user" class="span2" type="text" placeholder="Email">
                         <input id="password" class="span2" type="password" placeholder="Password">
                         <button id="loginButton" type="button" onclick=login() class="btn">Sign in</button>
			 <a href="{% url "socialauth_begin" "facebook" %}" class="btn btn-info">Facebook Sign in</a>
			 <a href="{% url "socialauth_begin" "google" %}" class="btn btn-inverse">Google</a>
			  {% else %}
			   <span class="userLogged">Hello  {{ user }}  </span>
			    <button id="logoutButton" type="button" onclick=logout() class="btn">Sign out</button>
			 {% endif %}  
                        </form>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>
{% block container %}

{% endblock container %}

<script>window.__BASEURL__ = '{% url 'api_root_endpoint' %}'</script>
<script src="{% static 'open311/js/vendor/underscore-min.js' %}"></script>
<script src="{% static 'open311/js/vendor/jquery-1.9.1.min.js' %}"></script>
<script src="{% static 'open311/js/vendor/bootstrap.min.js' %}"></script>
<script src="{% static 'open311/js/vendor/leaflet.js' %}"></script>
<script src="https://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
<script src="{% static 'open311/js/vendor/Google.js' %}"></script>
<script src="{% static 'open311/js/vendor/leaflet.markercluster.js' %}"></script>
<script src="{% static 'open311/js/vendor/jquery.raty.js' %}"></script>
<script type="text/javascript">
    $.myproject = {} // namespace
    $.myproject.STATIC_URL = '{{ STATIC_URL }}';
</script>
<script src="{% static 'open311/js/utils.js' %}"></script>
<script src="{% static 'open311/js/functions.js' %}"></script>
<script src="{% static 'open311/js/main.js' %}"></script>
{% block scripts%}

{% endblock scripts%}	



    </body>
</html>
